#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
export DH_VERBOSE=1
export DH_OPTIONS=-v

%:
	dh --with autotools-dev $@

override_dh_auto_clean:
	dh_auto_clean
	[ ! -f src/Makefile ] || $(MAKE) -C src spotless
	rm -f doc/texi-linearize doc/Fdutils.texi doc/Fdutils.html \
		src/floppymeter src/convertfdprm
	rm -f Makefile src/Makefile doc/Makefile
	rm -f configure config.log config.cache config.status config.h \
		config.h.in
	rm -fr autom4te.cache */autom4te.cache

override_dh_auto_configure:
	autoreconf -vfi
	dh_auto_configure

override_dh_auto_build:
	dh_auto_build -- all html

override_dh_auto_install:
	dh_auto_install
	( cd debian/fdutils && \
		mv usr/bin/MAKEFLOPPIES usr/sbin )

override_dh_installman:
	dh_installman
	( cd debian/fdutils/usr/share/man && \
		mv man1/makefloppies.1 man8/MAKEFLOPPIES.8 )
